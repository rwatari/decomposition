{"version":3,"sources":["webpack:///webpack/bootstrap dd85979bc491ae11291e","webpack:///./lib/decomposition.js","webpack:///./lib/simulation.js","webpack:///./lib/webgl_util.js","webpack:///./lib/simulation_js.js","webpack:///./lib/view.js"],"names":["simulation","view","renderWebGL","image","canvas","gl","getContext","alert","startButton","document","getElementById","addEventListener","toggle","renderJS","ctx","drawImage","simulationJS","width","height","viewJS","Image","crossOrigin","src","onload","modal","modalVisible","window","event","target","style","display","switchButton","webGLSim","newCanvas","cloneNode","parentNode","replaceChild","innerHTML","Simulation","GAMMA","DIFFUSE","setup","viewport","clearColor","clear","COLOR_BUFFER_BIT","vShaderSource","text","fShaderSourceGray","fShaderSourceShow","fShaderSourceStep","vShader","VERTEX_SHADER","fShaderGray","FRAGMENT_SHADER","fShaderShow","fShaderStep","programGray","programShow","programStep","positionAttribLoc","getAttribLocation","texCoordAttribLoc","texSizeUniformLoc","getUniformLocation","deltaTUniformLoc","texture0","pixelStorei","UNPACK_FLIP_Y_WEBGL","texImage2D","TEXTURE_2D","RGBA","UNSIGNED_BYTE","texture1","fbo0","fbo1","positions","texCoords","useProgram","bindTexture","bindFramebuffer","FRAMEBUFFER","drawArrays","TRIANGLE_STRIP","it","delta","uniform2f","uniform1f","flush","createShader","type","source","shader","shaderSource","compileShader","success","getShaderParameter","COMPILE_STATUS","console","log","getShaderInfoLog","deleteShader","createProgram","vertexShader","fragmentShader","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","createTexture","texture","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","createFramebuffer","fbo","framebufferTexture2D","COLOR_ATTACHMENT0","bindVertexAttrib","data","attributeLocation","size","FLOAT","normalize","stride","offset","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","resize","displayWidth","clientWidth","displayHeight","clientHeight","SimulationJS","imageData","getImageData","getGrayScaleData","Uint8ClampedArray","grayScaleData","i","length","avg","push","row","col","bufferIdx","pixelData","set","putImageData","laplacian","lapl","call","chemPot","map","conc","Math","pow","min","diff","newData","len","Array","n","w","e","s","View","run","start","lastTime","requestAnimationFrame","simulate","bind","time","draw","updateFPS","round"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap dd85979bc491ae11291e","import Simulation from './simulation';\nimport SimulationJS from './simulation_js';\nimport View from './view';\n\nimport {resize} from './webgl_util';\n\nlet simulation, view;\n\nconst renderWebGL = (image, canvas) => {\n  const gl = canvas.getContext(\"webgl\");\n  if (!gl) {\n    alert(\"You don't have WebGl enabled!\");\n    return;\n  }\n\n  const simulation = new Simulation(gl, image);\n  const view = new View(simulation);\n\n  const startButton = document.getElementById(\"start\");\n  startButton.addEventListener(\"click\", () => {\n    view.toggle(startButton);\n  });\n};\n\nconst renderJS = (image, canvas) => {\n  const ctx = canvas.getContext(\"2d\");\n  ctx.drawImage(image, 0, 0);\n\n  const simulationJS = new SimulationJS(ctx, canvas.width, canvas.height);\n  const viewJS = new View(simulationJS);\n\n  const startButton = document.getElementById(\"start\");\n  startButton.addEventListener(\"click\", () => {\n    viewJS.toggle(startButton);\n  });\n};\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const image = new Image();\n  image.crossOrigin = 'anonymous';\n  image.src = \"https://res.cloudinary.com/dpgudhebt/image/upload/c_crop,h_1080,w_1920/v1484899897/magic-cube-cube-puzzle-play-54101_kaeq1l.jpg\";\n  image.onload = () => {\n    let canvas = document.getElementById(\"canvas\");\n\n    canvas.width = image.width;\n    canvas.height = image.height;\n\n    renderWebGL(image, canvas);\n\n    const modal = document.getElementById(\"modal\");\n    let modalVisible = true;\n    window.addEventListener(\"click\", event => {\n      if (modalVisible && event.target === modal) {\n        modal.style.display = \"none\";\n      } else {\n        modal.style.display = \"flex\";\n      }\n      modalVisible = !modalVisible;\n    });\n\n    const switchButton = document.getElementById(\"switch\");\n    let webGLSim = true;\n    switchButton.addEventListener(\"click\", () => {\n      // resetting the context by creating a new canvas\n      let newCanvas = canvas.cloneNode(false);\n      canvas.parentNode.replaceChild(newCanvas, canvas);\n      canvas = newCanvas;\n\n      if (webGLSim) {\n        renderJS(image, canvas);\n        switchButton.innerHTML = \"Switch to WebGL\";\n      } else {\n        renderWebGL(image, canvas);\n        switchButton.innerHTML = \"Switch to JavaScript\"\n      }\n\n      webGLSim = !webGLSim;\n    });\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./lib/decomposition.js","import {\n  createShader,\n  createProgram,\n  createTexture,\n  createFramebuffer,\n  bindVertexAttrib\n} from './webgl_util';\n\nclass Simulation {\n  constructor(gl, image) {\n    this.gl = gl;\n    this.width = image.width;\n    this.height = image.height;\n    this.GAMMA = 0.5;\n    this.DIFFUSE = 2;\n    this.setup(image);\n  }\n\n  setup(image) {\n    const { gl, width, height } = this;\n    gl.viewport(0, 0, width, height); //set clip space\n    gl.clearColor(0, 0, 0, 0); // clear canvas\n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    // grabbing shader source and attaching them to make program\n    const vShaderSource = document.getElementById(\"v-shader\").text;\n    const fShaderSourceGray = document.getElementById(\"f-shader-gray\").text;\n    const fShaderSourceShow = document.getElementById(\"f-shader-show\").text;\n    const fShaderSourceStep = document.getElementById(\"f-shader-step\").text;\n\n    const vShader = createShader(gl, gl.VERTEX_SHADER, vShaderSource);\n    const fShaderGray = createShader(gl, gl.FRAGMENT_SHADER, fShaderSourceGray);\n    const fShaderShow = createShader(gl, gl.FRAGMENT_SHADER, fShaderSourceShow);\n    const fShaderStep = createShader(gl, gl.FRAGMENT_SHADER, fShaderSourceStep);\n\n    const programGray = createProgram(gl, vShader, fShaderGray);\n    const programShow = createProgram(gl, vShader, fShaderShow);\n    const programStep = createProgram(gl, vShader, fShaderStep);\n\n    // allow shaders to access variables\n    const positionAttribLoc = gl.getAttribLocation(programGray, \"a_position\");\n    const texCoordAttribLoc = gl.getAttribLocation(programGray, \"a_texCoord\");\n    const texSizeUniformLoc = gl.getUniformLocation(programStep, \"u_textureSize\");\n    const deltaTUniformLoc = gl.getUniformLocation(programStep, \"u_deltaT\");\n\n    // original image loaded into this texture\n    const texture0 = createTexture(gl);\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true); // load image without flipping upside down\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n    const texture1 = createTexture(gl);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\n    // create framebuffer to attach texture\n    const fbo0 = createFramebuffer(gl, texture0);\n    const fbo1 = createFramebuffer(gl, texture1);\n\n    // bind vertex attributes to position and texture coordinate bounds\n    const positions = [\n      -1., -1.,\n       1., -1.,\n      -1.,  1.,\n       1.,  1.\n    ];\n    bindVertexAttrib(gl, positions, positionAttribLoc);\n\n    const texCoords = [\n      0., 0.,\n      1., 0.,\n      0., 1.,\n      1., 1.\n    ];\n    bindVertexAttrib(gl, texCoords, texCoordAttribLoc);\n\n    // uniform2f needs to come after program declaration\n    // location needs to be attached to program\n    // bind texture to read from\n    // bind framebuffer to render to\n    gl.useProgram(programGray);\n    gl.bindTexture(gl.TEXTURE_2D, texture0);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fbo1);\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n    gl.useProgram(programShow);\n    gl.bindTexture(gl.TEXTURE_2D, texture1);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n    this.programShow = programShow;\n    this.programStep = programStep;\n    this.texture0 = texture0;\n    this.texture1 = texture1;\n    this.fbo0 = fbo0;\n    this.fbo1 = fbo1;\n    this.texSizeUniformLoc = texSizeUniformLoc;\n    this.deltaTUniformLoc = deltaTUniformLoc;\n    this.it = -1;\n  }\n\n  draw(delta) {\n    const {\n      gl, width, height,\n      programStep, programShow,\n      texture0, texture1,\n      fbo0, fbo1,\n      texSizeUniformLoc, deltaTUniformLoc,\n      it\n    } = this;\n\n    gl.useProgram(programStep);\n    gl.uniform2f(texSizeUniformLoc, width, height);\n    gl.uniform1f(deltaTUniformLoc, delta);\n    if (it > 0) {\n      gl.bindTexture(gl.TEXTURE_2D, texture0);\n      gl.bindFramebuffer(gl.FRAMEBUFFER, fbo1);\n    } else {\n      gl.bindTexture(gl.TEXTURE_2D, texture1);\n      gl.bindFramebuffer(gl.FRAMEBUFFER, fbo0);\n    }\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    gl.useProgram(programShow);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    gl.flush();\n    this.it = -it;\n  }\n}\n\nexport default Simulation;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/simulation.js","/*\nThese utility functions are based on the content from\nhttps://webglfundamentals.org\n*/\n\nexport const createShader = (gl, type, source) => {\n  const shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  if (success) return shader;\n\n  console.log(gl.getShaderInfoLog(shader));\n  gl.deleteShader(shader);\n};\n\nexport const createProgram = (gl, vertexShader, fragmentShader) => {\n  const program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n  if (success) return program;\n\n  console.log(gl.getProgramInfoLog(program));\n  gl.deleteProgram(program);\n};\n\nexport const createTexture = gl => {\n  const texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n  return texture;\n};\n\nexport const createFramebuffer = (gl, texture) => {\n  const fbo = gl.createFramebuffer();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\n  gl.framebufferTexture2D(\n    gl.FRAMEBUFFER,\n    gl.COLOR_ATTACHMENT0,\n    gl.TEXTURE_2D,\n    texture,\n    0\n  );\n  return fbo;\n}\n\nexport const bindVertexAttrib = (\n  gl,\n  data,\n  attributeLocation,\n  size = 2,           // read two data points at a time\n  type = gl.FLOAT,    // read data as floats\n  normalize = false,\n  stride = 0,\n  offset = 0\n) => {\n  const buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);\n\n  gl.enableVertexAttribArray(attributeLocation);\n  gl.vertexAttribPointer(attributeLocation, size, type, normalize, stride, offset);\n}\n\nexport const resize = (canvas) => {\n  // Lookup the size the browser is displaying the canvas.\n  var displayWidth  = canvas.clientWidth;\n  var displayHeight = canvas.clientHeight;\n\n  // Check if the canvas is not the same size.\n  if (canvas.width  != displayWidth ||\n      canvas.height != displayHeight) {\n\n    // Make the canvas the same size\n    canvas.width  = displayWidth;\n    canvas.height = displayHeight;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/webgl_util.js","class SimulationJS {\n  constructor(ctx, width, height) {\n    this.ctx = ctx;\n    this.imageData = ctx.getImageData(0, 0, width, height);\n    this.width = width;\n    this.height = height;\n    this.data = this.getGrayScaleData();\n    this.buffer = new Uint8ClampedArray(width * height * 4);\n    this.GAMMA = 0.5;\n    this.DIFFUSE = 2;\n  }\n\n  getGrayScaleData() {\n    const data = this.imageData.data;\n    const grayScaleData = [];\n\n    for (let i = 0; i < data.length; i += 4) {\n      let avg = (data[i] + data[i + 1] + data[i + 2]) / 3;\n      grayScaleData.push((avg - 128) / 256);\n    }\n\n    return grayScaleData;\n  }\n\n  draw() {\n    const { height, width, buffer, data, imageData, ctx } = this;\n    for (let row = 0; row < height; row++) {\n      for (let col = 0; col < width; col++) {\n        let i = row * width + col;\n        let bufferIdx = i * 4;\n        let pixelData = data[i] * 256 + 128;\n        buffer[bufferIdx] = pixelData;\n        buffer[bufferIdx + 1] = pixelData;\n        buffer[bufferIdx + 2] = pixelData;\n        buffer[bufferIdx + 3] = 255;\n      }\n    }\n\n    imageData.data.set(buffer);\n\n    ctx.putImageData(imageData, 0, 0);\n  }\n\n  step() {\n    const { height, width, data, GAMMA, DIFFUSE, laplacian } = this;\n    const delta = 20;\n    const lapl = laplacian.call(this, data);\n    const chemPot = data.map((conc, i) => (\n      Math.pow(conc, 3)- conc - GAMMA * lapl[i]\n    ));\n\n    //Add console log to see maximum value of chemical potential\n    console.log(Math.min(...chemPot));\n    const diff = laplacian.call(this, chemPot);\n\n    const newData = data.map((conc, i) => (\n      conc + (DIFFUSE * diff[i] * delta / 1000)\n    ));\n\n    this.data = newData;\n  }\n\n  laplacian(data) {\n    const { height, width } = this;\n    const len = data.length;\n    const lapl = new Array(len);\n\n    for (let row = 0; row < height; row++) {\n      for (let col = 0; col < width; col++) {\n        let i = row * width + col;\n        let n = (row === 0) ? (i - width + len) : (i - width);\n        let w = (col === 0) ? (i - 1 + width) : (i - 1);\n        let e = (col === width - 1) ? (i + 1 - width) : (i + 1);\n        let s = (row === height - 1) ? (i + width - len) : (i + width);\n\n        lapl[i] = (\n          data[n]\n          + data[w]\n          + data[e]\n          + data[s]\n          - 4 * data[i]\n        );\n      }\n    }\n    return lapl;\n  }\n\n}\n\nexport default SimulationJS;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/simulation_js.js","class View {\n  constructor(simulation) {\n    this.simulation = simulation;\n    this.run = false;\n  }\n\n  toggle(startButton) {\n    if (this.run) {\n      this.run = false;\n      startButton.innerHTML = \"Start\";\n    } else {\n      this.run = true;\n      startButton.innerHTML = \"Stop\";\n      this.start();\n    }\n  }\n\n  start() {\n    this.lastTime = 0;\n    requestAnimationFrame(this.simulate.bind(this));\n  }\n\n  simulate(time) {\n    if (!this.run) return;\n    const delta = time - this.lastTime;\n    this.simulation.draw(delta);\n    this.lastTime = time;\n    this.updateFPS(delta);\n    requestAnimationFrame(this.simulate.bind(this));\n  }\n\n  updateFPS(delta) {\n    document.getElementById(\"fps\").innerHTML = Math.round(1000/delta);\n  }\n}\n\nexport default View;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/view.js"],"sourceRoot":""}